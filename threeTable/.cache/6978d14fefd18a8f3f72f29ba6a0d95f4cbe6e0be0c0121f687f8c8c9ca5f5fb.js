{"source":"(window.webpackJsonp=window.webpackJsonp||[]).push([[\"chunk-65cc2213\"],{\"064d\":function(e,t,a){},\"467b\":function(e,t,a){\"use strict\";a(\"7364\"),a(\"d4d5\");var r={name:\"compName\",components:{},filters:{},props:{updateObj:{type:Object,default:function(){},required:!1},taskId:{type:Number,default:null,required:!1}},data:function(){return{options:[{lable:1,value:1}],list:[],loading:!1,updateForm:{id:\"\",projectNumber:\"\",principalAdminCode:\"\",moduleId:\"\",moduleName:\"\",name:\"\",description:\"\",lineName:\"\",planStartTime:\"\",planEndTime:\"\",planManHours:\"\"},updateRuleForm:{projectNumber:[{required:!0,message:\"请输入项目编号\"}],moduleId:[{required:!0,message:\"请选择模块\"}],name:[{required:!0,message:\"请输入任务名称\"}],description:[{required:!0,message:\"请输入任务描述\"}],roleId:[{required:!0,message:\"请输入角色\"}],planStartTime:[{required:!0,message:\"请选择计划开始时间\"}],planEndTime:[{required:!0,message:\"请选择计划结束时间\"}],planManHours:[{required:!0,message:\"请输入预计投入工时\"}],principalAdminName:[{required:!0,message:\"\"}],reason:[{required:!0,message:\"请输入修改原因\"}]}}},computed:{},watch:{updateObj:{handler:function(e,t){this.updateForm.taskId=this.taskId,this.updateForm.id=e.id,this.updateForm.taskId=e.id,this.updateForm.projectNumber=e.projectNumber,this.updateForm.projectName=e.projectName,this.updateForm.principalAdminCode=e.principalAdminCode,this.updateForm.principalAdminName=e.principalAdminName,this.updateForm.moduleId=e.moduleId,this.updateForm.moduleName=e.moduleName,this.updateForm.name=e.name,this.updateForm.description=e.description,this.updateForm.lineName=e.lineName,this.updateForm.planStartTime=e.planStartTime,this.updateForm.planEndTime=e.planEndTime,this.updateForm.planManHours=e.planManHours},deep:!0,immediate:!0}},created:function(){},methods:{handlerDate:function(e,t,a){this.$moment(t.planEndTime).valueOf()<this.$moment(t.planStartTime).valueOf()&&(t[a]=\"\",this.$message({showClose:!0,message:\"预计完成时间不能小于计划开始时间\",type:\"warning\"}))},save:function(){var e=this;24<self.updateForm.manHours||self.updateForm.manHours<=0?self.$message({showClose:!0,message:\"工时范围必须为0~24之间\",type:\"warning\"}):this.$confirm(\"确认提交?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){e.$message({type:\"success\",message:\"提交成功!\"}),e.$backTo()}).catch(function(){e.$message({type:\"info\",message:\"已取消\"})})},commitUpdate:function(){var t=this;t.$http.post(\"/admin/tfTask/update.d\",t.updateForm,function(e){t.$emit(\"cancel\"),t.$message({showClose:!0,message:\"修改成功\",type:\"success\"})},function(e){t.$message({showClose:!0,message:e.result.msg,type:\"warning\"})},function(e){t.$message({showClose:!0,message:e.error+\"-\"+e.message,type:\"warning\"}),t.loading=!1})}}},o=(a(\"7eb6\"),a(\"6691\")),n=Object(o.a)(r,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",{staticClass:\"compName w100\"},[a(\"el-form\",{ref:\"updateRuleForm\",attrs:{model:t.updateForm,rules:t.updateRuleForm,\"status-icon\":\"\",\"label-width\":\"100px\"}},[a(\"el-form-item\",{attrs:{label:\"项目编号\",prop:\"projectNumber\"}},[a(\"el-input\",{attrs:{maxlength:50,placeholder:\"请项目编号\",name:\"projectNumber\",disabled:!0,\"auto-complete\":\"off\"},model:{value:t.updateForm.projectNumber,callback:function(e){t.$set(t.updateForm,\"projectNumber\",\"string\"==typeof e?e.trim():e)},expression:\"updateForm.projectNumber\"}})],1),a(\"el-form-item\",{attrs:{label:\"项目名称\",prop:\"projectNumber\"}},[a(\"el-input\",{attrs:{maxlength:50,placeholder:\"项目名称\",name:\"projectName\",disabled:!0,\"auto-complete\":\"off\"},model:{value:t.updateForm.projectName,callback:function(e){t.$set(t.updateForm,\"projectName\",\"string\"==typeof e?e.trim():e)},expression:\"updateForm.projectName\"}})],1),a(\"el-form-item\",{attrs:{label:\"工作模块\",prop:\"name\"}},[a(\"el-input\",{attrs:{maxlength:50,placeholder:\"\",name:\"moduleName\",disabled:!0,\"auto-complete\":\"off\"},model:{value:t.updateForm.moduleName,callback:function(e){t.$set(t.updateForm,\"moduleName\",\"string\"==typeof e?e.trim():e)},expression:\"updateForm.moduleName\"}})],1),a(\"el-form-item\",{attrs:{label:\"任务名称\",prop:\"name\"}},[a(\"el-input\",{attrs:{maxlength:50,placeholder:\"输入任务名称\",name:\"name\",\"auto-complete\":\"off\"},model:{value:t.updateForm.name,callback:function(e){t.$set(t.updateForm,\"name\",\"string\"==typeof e?e.trim():e)},expression:\"updateForm.name\"}})],1),a(\"el-form-item\",{attrs:{label:\"任务描述\",prop:\"name\"}},[a(\"el-input\",{attrs:{maxlength:50,placeholder:\"输入任务描述\",name:\"name\",\"auto-complete\":\"off\"},model:{value:t.updateForm.description,callback:function(e){t.$set(t.updateForm,\"description\",\"string\"==typeof e?e.trim():e)},expression:\"updateForm.description\"}})],1),a(\"el-form-item\",{attrs:{label:\"计划开始时间\",prop:\"name\"}},[a(\"el-date-picker\",{attrs:{type:\"date\",\"value-format\":\"yyyy-MM-dd\",placeholder:\"计划开始时间\"},on:{change:function(e){t.handlerDate(e,t.updateForm,\"planStartTime\")}},model:{value:t.updateForm.planStartTime,callback:function(e){t.$set(t.updateForm,\"planStartTime\",e)},expression:\"updateForm.planStartTime\"}})],1),a(\"el-form-item\",{attrs:{label:\"预计完成时间\",prop:\"planEndTime\"}},[a(\"el-date-picker\",{attrs:{type:\"date\",\"value-format\":\"yyyy-MM-dd\",placeholder:\"预计完成时间\"},on:{change:function(e){t.handlerDate(e,t.updateForm,\"planEndTime\")}},model:{value:t.updateForm.planEndTime,callback:function(e){t.$set(t.updateForm,\"planEndTime\",e)},expression:\"updateForm.planEndTime\"}})],1),a(\"el-form-item\",{attrs:{label:\"预计投入工时\",prop:\"planManHours\"}},[a(\"el-input\",{attrs:{placeholder:\"预计投入工时\",clearable:\"\"},model:{value:t.updateForm.planManHours,callback:function(e){t.$set(t.updateForm,\"planManHours\",e)},expression:\"updateForm.planManHours\"}})],1),a(\"el-form-item\",{attrs:{label:\"指派给\",prop:\"principalAdminName\"}},[a(\"el-input\",{attrs:{placeholder:\"\",clearable:\"\",disabled:!0},model:{value:t.updateForm.principalAdminName,callback:function(e){t.$set(t.updateForm,\"principalAdminName\",e)},expression:\"updateForm.principalAdminName\"}})],1),a(\"el-form-item\",{attrs:{label:\"修改原因\",prop:\"reason\"}},[a(\"el-input\",{attrs:{maxlength:50,placeholder:\"请输入修改原因\",name:\"reason\",\"auto-complete\":\"off\"},model:{value:t.updateForm.reason,callback:function(e){t.$set(t.updateForm,\"reason\",\"string\"==typeof e?e.trim():e)},expression:\"updateForm.reason\"}})],1)],1),a(\"div\",{staticClass:\"w100 flex_row_center padding1\"},[a(\"el-button\",{attrs:{type:\"primary\"},on:{click:function(e){return t.commitUpdate()}}},[t._v(\"保存\")]),a(\"el-button\",{on:{click:function(e){return t.$emit(\"cancel\")}}},[t._v(\"返回\")])],1)],1)},[],!1,null,\"3e0ee58e\",null);t.a=n.exports},7364:function(e,t,a){var r=a(\"ddf7\").f,o=Function.prototype,n=/^\\s*function ([^ (]*)/;\"name\"in o||a(\"dad2\")&&r(o,\"name\",{configurable:!0,get:function(){try{return(\"\"+this).match(n)[1]}catch(e){return\"\"}}})},\"7eb6\":function(e,t,a){\"use strict\";var r=a(\"9b41\");a.n(r).a},\"821d\":function(e,t,a){\"use strict\";var r=a(\"064d\");a.n(r).a},\"9b41\":function(e,t,a){},ef59:function(e,t,a){\"use strict\";a.r(t);var r={name:\"update-task\",components:{UpdateTask:a(\"467b\").a},filters:{},props:{},data:function(){return{updateTaskDialog:!1,departName:this.$store.getters[\"user/getInfo\"]&&this.$store.getters[\"user/getInfo\"].deptName,groupName:this.$store.getters[\"user/getInfo\"]&&this.$store.getters[\"user/getInfo\"].groupName,tableData:[{id:2,name:\"test\",value:1},{id:1,name:\"test\",value:1}],searchObj:{page:1,pageSize:15,taskId:this.$route.query.taskId},taskLogList:[],updateObj:{},taskName:\"\",total:100,loading:!1}},computed:{ifShowUpdate:function(){return!this.$isEmpty(this.$route.query.taskStatus)&&3!=this.$route.query.taskStatus&&2!=this.$route.query.taskStatus}},watch:{},created:function(){this.refresh()},methods:{refresh:function(){this.getTaskLog()},updateTask:function(){3!=this.$route.query.taskStatus?2!=this.$route.query.taskStatus?this.updateTaskDialog=!0:this.$message({showClose:!0,message:\"该任务已完成，无法修改\",type:\"warning\"}):this.$message({showClose:!0,message:\"该任务已关闭，无法修改\",type:\"warning\"})},getTaskLog:function(){var t=this;t.loading=!0,t.$http.post(\"/admin/tfTaskLog/listByPage.d\",t.searchObj,function(e){t.taskLogList=e.body.rows,t.updateObj=t.taskLogList[0],t.total=e.body.total,t.loading=!1},function(e){t.$message({showClose:!0,message:e.result.msg,type:\"warning\"}),t.loading=!1},function(e){t.$message({showClose:!0,message:e.error+\"-\"+e.message,type:\"warning\"}),t.loading=!1})}}},o=(a(\"821d\"),a(\"6691\")),n=Object(o.a)(r,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",{staticClass:\"update-task w100 h100 flex column\"},[a(\"div\",{staticClass:\"bg_white pos padding2 padding-left4 no_shrink\"},[a(\"el-breadcrumb\",{attrs:{\"separator-class\":\"iconfont icon-you \"}},[a(\"el-breadcrumb-item\",[t._v(\"明珞\")]),a(\"el-breadcrumb-item\",[t._v(t._s(t.departName))]),a(\"el-breadcrumb-item\",[t._v(t._s(t.groupName))]),a(\"el-breadcrumb-item\",[a(\"span\",{staticClass:\"navItem\",on:{click:function(e){return t.$backTo()}}},[t._v(\"任务\")])]),a(\"el-breadcrumb-item\",[t._v(\"修改历史\")])],1)],1),a(\"div\",{staticClass:\"w100 h100 rel\"},[a(\"el-dialog\",{staticClass:\"updateTaskDialog dialogCenter\",attrs:{title:\"修改历史\",\"modal-append-to-body\":!1,\"close-on-click-modal\":!1,visible:t.updateTaskDialog,\"destroy-on-close\":!0},on:{\"update:visible\":function(e){t.updateTaskDialog=e}}},[a(\"UpdateTask\",{attrs:{updateObj:t.updateObj,taskId:Number(t.$route.query.taskId)},on:{cancel:function(e){t.updateTaskDialog=!1,t.refresh()}}})],1),a(\"div\",{staticClass:\"task-status fs_13 padding2 padding-left4  flex_row_between w100\"},[a(\"span\",[t._v(t._s(t.updateObj.name))]),a(\"div\",{staticClass:\"flex_row_start\"},[a(\"el-button\",{staticClass:\"fs_13 flex_row_center\",attrs:{type:\"primary\",icon:\"icon-fanhui iconfont fs_13\"},on:{click:function(e){return t.$backTo()}}},[t._v(\"返回\")]),a(\"el-button\",{staticClass:\"fs_13 margin-right4\",attrs:{type:\"primary\"},on:{click:function(e){return t.updateTask()}}},[t._v(\"修改任务\")])],1)]),a(\"div\",{staticClass:\"update-task-table bg_white  margin-left4 margin-right4 border\"},[a(\"CommonTable\",{attrs:{tableData:t.taskLogList,refreshFuncName:\"refresh\",\"default-sort\":{prop:\"id\",order:\"ascending\"}}},[a(\"template\",{slot:\"main\"},[a(\"el-table-column\",{attrs:{align:\"center\",type:\"index\",label:\"序号\",width:\"70\",sortable:\"\"}}),a(\"el-table-column\",{attrs:{align:\"center\",prop:\"projectNumber\",label:\"项目编号\",width:\"100\",sortable:\"\"}}),a(\"el-table-column\",{attrs:{align:\"center\",prop:\"projectName\",label:\"项目名称\",width:\"100\",sortable:\"\"}}),a(\"el-table-column\",{attrs:{align:\"center\",prop:\"lineName\",label:\"线体\",width:\"100\",sortable:\"\"}}),a(\"el-table-column\",{attrs:{align:\"center\",prop:\"moduleName\",label:\"工作模块\",width:\"100\",sortable:\"\"}}),a(\"el-table-column\",{attrs:{align:\"center\",prop:\"name\",label:\"任务名称\"}}),a(\"el-table-column\",{attrs:{align:\"center\",prop:\"description\",label:\"描述\"}}),a(\"el-table-column\",{attrs:{align:\"center\",prop:\"planStartTime\",label:\"计划开始时间\",width:\"120\",sortable:\"\"}}),a(\"el-table-column\",{attrs:{align:\"center\",prop:\"planEndTime\",label:\"计划完成时间\",width:\"120\",sortable:\"\"}}),a(\"el-table-column\",{attrs:{align:\"center\",prop:\"planManHours\",label:\"预计工时\",width:\"80\"}}),a(\"el-table-column\",{attrs:{align:\"center\",prop:\"principalAdminName\",label:\"指派给\",width:\"80\"}}),a(\"el-table-column\",{attrs:{align:\"center\",prop:\"createAdminName\",label:\"创建人\",width:\"80\"}}),a(\"el-table-column\",{attrs:{align:\"center\",prop:\"reason\",label:\"修改原因\",width:\"80\"}}),a(\"el-table-column\",{attrs:{align:\"center\",prop:\"createTime\",label:\"修改时间\",width:\"90\"}})],1)],2)],1)],1)])},[],!1,null,\"3e74170a\",null);t.default=n.exports}}]);"}